(function(a){function x(){a.ajax({url:l,cache:!1}).done(function(a){c.html('<div class="vbox-inline">'+a+"</div>");g(!0)}).fail(function(){c.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>');g(!0)})}function y(){c.html('<iframe class="venoframe" src="'+l+'"></iframe>');g()}function z(){var a=l.split("/");c.html('<iframe class="venoframe" src="//player.vimeo.com/video/'+a[a.length-1]+'"></iframe>');g()}function A(){var a=l.split("/");c.html('<iframe class="venoframe" allowfullscreen src="//www.youtube.com/embed/'+
a[a.length-1]+'"></iframe>');g()}function B(){c.html('<div class="vbox-inline">'+a(l).html()+"</div>");g()}function C(){N=a(".vbox-content").find("img");N.one("load",function(){g()}).each(function(){this.complete&&a(this).load()})}function g(d){1!=(d||!1)&&a(window).scrollTop(0);D.html(u);c.find(">:first-child").addClass("figlio");a(".figlio").css("width",E).css("height",F).css("padding",G).css("background",H);m=c.outerHeight();q=a(window).height();m+80<q?(r=(q-m)/2,c.css("margin-top",r),c.css("margin-bottom",
    r)):(c.css("margin-top","40px"),c.css("margin-bottom","40px"));c.animate({opacity:"1"},"slow","swing");e.addClass("open")}var K,L,n,e,E,G,H,F,r,m,q,O,M,P,c,Q,l,p,N,R,h,d,f,u,v,w,t,D,I,S;a.fn.extend({venobox:function(g){var k=a.extend({framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0},g);return this.each(function(){var b=a(this);if(b.data("venobox"))return!0;b.addClass("vbox-item");b.data("framewidth",k.framewidth);b.data("frameheight",
    k.frameheight);b.data("border",k.border);b.data("bgcolor",k.bgcolor);b.data("numeratio",k.numeratio);b.data("infinigall",k.infinigall);b.data("overlayclose",k.overlayclose);b.data("venobox",!0);K=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;L=document.all&&!window.atob?!0:!1;b.click(function(g){function m(){R=b.data("gall");O=b.data("numeratio");P=b.data("infinigall");h=a('.vbox-item[data-gall="'+R+'"]');0<h.length&&!0===O?(I.html(h.index(b)+1+" / "+h.length),I.fadeIn()):I.fadeOut();d=h.eq(h.index(b)+
1);f=h.eq(h.index(b)-1);b.attr(k.titleattr)?(u=b.attr(k.titleattr),D.fadeIn()):(u="",D.fadeOut());0<h.length&&!0===P?(w=v=!0,1>d.length&&(d=h.eq(0)),1>h.index(b)&&(f=h.eq(h.index(h.length)))):(0<d.length?(a(".vbox-next").css("display","block"),v=!0):(a(".vbox-next").css("display","none"),v=!1),0<h.index(b)?(a(".vbox-prev").css("display","block"),w=!0):(a(".vbox-prev").css("display","none"),w=!1))}function q(a){27===a.keyCode&&r()}function r(){a("body").unbind("keydown",q);L?e.animate({opacity:0},
    500,function(){e.remove();a(".vwrap").children().unwrap();a(window).scrollTop(-p);t=!1;b.focus()}):(e.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),e.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(c){c.target==c.currentTarget&&(e.remove(),K?(a(".vwrap").bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){a(".vwrap").children().unwrap();a(window).scrollTop(-p)}),a(".vwrap").css("opacity","1")):(a(".vwrap").children().unwrap(),
    a(window).scrollTop(-p)),t=!1,b.focus())}),e.css("opacity","0"),e.removeClass("open"),e.addClass("close"))}g.stopPropagation();g.preventDefault();b=a(this);n=b.data("overlay");E=b.data("framewidth");F=b.data("frameheight");G=b.data("border");H=b.data("bgcolor");t=w=v=!1;l=b.attr("href");p=a(window).scrollTop();p=-p;S=b.data("css")||"";a("body").wrapInner('<div class="vwrap"></div>');M=a(".vwrap");Q='<div class="vbox-overlay '+S+'" style="background:'+n+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>';
    a("body").append(Q);e=a(".vbox-overlay");a(".vbox-container");c=a(".vbox-content");I=a(".vbox-num");D=a(".vbox-title");c.html("");c.css("opacity","0");m();e.css("min-height",a(window).outerHeight());L?e.animate({opacity:1},250,function(){e.addClass("open");e.css({"min-height":a(window).outerHeight(),height:"auto"});"iframe"==b.data("type")?y():"inline"==b.data("type")?B():"ajax"==b.data("type")?x():"vimeo"==b.data("type")?z():"youtube"==b.data("type")?A():(c.html('<img src="'+l+'">'),C())}):(e.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",
        function(d){d.target==d.currentTarget&&(e.css({"min-height":a(window).outerHeight(),height:"auto"}),"iframe"==b.data("type")?y():"inline"==b.data("type")?B():"ajax"==b.data("type")?x():"vimeo"==b.data("type")?z():"youtube"==b.data("type")?A():(c.html('<img src="'+l+'">'),C()))}),e.css("opacity","1"));K?M.css({position:"fixed",top:p,opacity:"0"}).data("top",p):(M.css({position:"fixed",top:p}).data("top",p),a(window).scrollTop(0));var J={prev:function(){t||(t=!0,n=f.data("overlay"),E=f.data("framewidth"),
        F=f.data("frameheight"),G=f.data("border"),H=f.data("bgcolor"),l=f.attr("href"),u=f.attr(k.titleattr)?f.attr(k.titleattr):"",void 0===n&&(n=""),e.css("min-height",a(window).outerHeight()),c.animate({opacity:0},500,function(){e.css("min-height",a(window).outerHeight()).css("background",n);"iframe"==f.data("type")?y():"inline"==f.data("type")?B():"ajax"==f.data("type")?x():"youtube"==f.data("type")?A():"vimeo"==f.data("type")?z():(c.html('<img src="'+l+'">'),C());b=f;m();t=!1}))},next:function(){t||
    (t=!0,n=d.data("overlay"),E=d.data("framewidth"),F=d.data("frameheight"),G=d.data("border"),H=d.data("bgcolor"),l=d.attr("href"),u=d.attr(k.titleattr)?d.attr(k.titleattr):"",void 0===n&&(n=""),e.css("min-height",a(window).outerHeight()),c.animate({opacity:0},500,function(){e.css("min-height",a(window).outerHeight()).css("background",n);"iframe"==d.data("type")?y():"inline"==d.data("type")?B():"ajax"==d.data("type")?x():"youtube"==d.data("type")?A():"vimeo"==d.data("type")?z():(c.html('<img src="'+
    l+'">'),C());b=d;m();t=!1}))}};a("body").keydown(function(a){37==a.keyCode&&1==w&&J.prev();39==a.keyCode&&1==v&&J.next()});a(".vbox-prev").click(function(){J.prev()});a(".vbox-next").click(function(){J.next()});g=".vbox-close, .vbox-overlay";b.data("overlayclose")||(g=".vbox-close");a(g).click(function(b){a(b.target).is(".figlio")||a(b.target).is(".vbox-next")||a(b.target).is(".vbox-prev")||a(b.target).is(".figlio *")||r()});a("body").keydown(q);return!1})})}});a(window).resize(function(){a(".vbox-content").length&&
(m=c.height(),q=a(window).height(),m+80<q?(r=(q-m)/2,c.css("margin-top",r),c.css("margin-bottom",r)):(c.css("margin-top","40px"),c.css("margin-bottom","40px")))})})(jQuery);